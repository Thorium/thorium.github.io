<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- 
      The Actor-model and Agent-model
 parameters will be replaced with the 
      document title extracted from the <h1> element or
      file name, if there is no <h1> heading
    -->
    <title>Actor-model and Agent-model
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="../content/style.css" />
	<meta name="robots" content="index,follow" />
	<meta name="rating" content="general" />
	<meta name="generator" content="FSharp.Formatting.2.4.2 by Tomas Petricek" />
	<meta name="Author" content="Tuomas Hietanen, 2014" />
    <script src="../content/tips.js" type="text/javascript"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
	<style type="text/css" id="custom-background-css">
		body { background-color: #E9E9E9; background-image: url('../content/FStAUS.png'); background-repeat: repeat; background-position: top left; background-attachment: fixed; }
		.container { background-color: #FFFFFF; border: solid 1px #000000; }
	</style>
  </head>
  <body class="bg">
	<a href="http://www.meetup.com/FSharpHelsinki/events/173790412/"><div style="margin: 5px; text-align: center; color:gray;">The Greater Helsinki Area F# User Group<br/></div></a>
    <div class="container">
      <div class="row" style="margin-top:30px">
        <div class="span1"></div>
        <div class="span10" id="main">
          <h1>Actor-model and Agent-model</h1>

<p>When talking about the Actor-model, the term "Actor" refers to verb act as "someone who does something", not "someone who acts like doing". When talking about the Agent-model, the term "Agent" refers also to "someone who does something" or "represents" (like agency), but not "secret agent". Actor-model is not an alternative to domain-model: Actor-model is not actually an abstract data model, but more like a concrete way to implement the program state.</p>

<p>If you want to test speed in interactive, just type:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#time</span> <span class="s">&quot;</span><span class="s">on</span><span class="s">&quot;</span>;;</pre>
</td>
</tr>
</table>

<h2>Parallelism</h2>

<p>There are three types of doing parallelism:</p>

<ul>
<li>Parallel Execution
<ul>
<li>Run the same code path simultaneously in multiple threads.</li>
<li>Suits well for parallel set-theory operations for collection of independent items</li>
<li>Suits well for CPU-bound resources when a lot of CPU-cycles available.</li>
<li>.NET-environment: Task Parallel Library (TPL), .AsParallel()</li>
</ul></li>
<li>Concurrency.
<ul>
<li>Run separate code paths simultaneously.</li>
<li>Suits well when resources are something else than CPU-bound: e.g. I/O or if just "waiting for synchronization".</li>
<li>Based on giving away the thread when not using it: Everyone else should also do that!</li>
<li>.NET-environment: Async-await</li>
<li>Used in message based ("Message Passing") architectures</li>
</ul></li>
<li>Lock the threads and the state
<ul>
<li>No parallelism</li>
<li>No synchronization issues</li>
<li>.NET: lock</li>
<li>Scalability and performance problems</li>
</ul></li>
</ul>

<p>To more concrete example, here are three little programs that enumerate a collection of items through and sleeps a while in every item while enumerating that item:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
<span class="l">35: </span>
<span class="l">36: </span>
<span class="l">37: </span>
<span class="l">38: </span>
<span class="l">39: </span>
<span class="l">40: </span>
<span class="l">41: </span>
<span class="l">42: </span>
<span class="l">43: </span>
<span class="l">44: </span>
<span class="l">45: </span>
<span class="l">46: </span>
<span class="l">47: </span>
<span class="l">48: </span>
<span class="l">49: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#time</span><span class="inactive"> </span><span class="inactive">&quot;on&quot;</span>
<span class="prep">#endif</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 2)" onmouseover="showTip(event, 'fs1', 2)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="i">Threading</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 4)" onmouseover="showTip(event, 'fs1', 4)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 5)" onmouseover="showTip(event, 'fs2', 5)" class="i">Threading</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="i">Tasks</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="i">Execution</span>() <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="i">iteri</span>() <span class="o">=</span> 
        [|<span class="n">1..</span><span class="n">1000</span>|] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="i">map</span>(
            <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">i</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">Thread</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="i">Sleep</span> <span class="n">200</span> <span class="c">//Lock the thread</span>
                <span class="k">match</span> <span onmouseout="hideTip(event, 'fs8', 14)" onmouseover="showTip(event, 'fs8', 14)" class="i">i</span> <span class="o">%</span> <span class="n">250</span> <span class="k">with</span>
                | <span class="n">0</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Item</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs8', 17)" onmouseover="showTip(event, 'fs8', 17)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">ToString</span>())
                | _ <span class="k">-&gt;</span> ()
        )
    <span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 20)" onmouseover="showTip(event, 'fs12', 20)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Starting</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 21)" onmouseover="showTip(event, 'fs14', 21)" class="i">complete</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 22)" onmouseover="showTip(event, 'fs5', 22)" class="i">iteri</span>()
    <span onmouseout="hideTip(event, 'fs11', 23)" onmouseover="showTip(event, 'fs11', 23)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 24)" onmouseover="showTip(event, 'fs12', 24)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Done</span><span class="s">&quot;</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 25)" onmouseover="showTip(event, 'fs15', 25)" class="i">ParallelExecution</span>() <span class="o">=</span> <span class="c">//TPL</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 26)" onmouseover="showTip(event, 'fs5', 26)" class="i">iteri</span>() <span class="o">=</span> 
        [|<span class="n">1..</span><span class="n">1000</span>|] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 27)" onmouseover="showTip(event, 'fs6', 27)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="i">Parallel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="i">map</span>(
            <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs8', 30)" onmouseover="showTip(event, 'fs8', 30)" class="i">i</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs9', 31)" onmouseover="showTip(event, 'fs9', 31)" class="i">Thread</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 32)" onmouseover="showTip(event, 'fs10', 32)" class="i">Sleep</span> <span class="n">200</span>
                <span class="k">match</span> <span onmouseout="hideTip(event, 'fs8', 33)" onmouseover="showTip(event, 'fs8', 33)" class="i">i</span> <span class="o">%</span> <span class="n">250</span> <span class="k">with</span>
                | <span class="n">0</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 34)" onmouseover="showTip(event, 'fs11', 34)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 35)" onmouseover="showTip(event, 'fs12', 35)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Item</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs8', 36)" onmouseover="showTip(event, 'fs8', 36)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 37)" onmouseover="showTip(event, 'fs13', 37)" class="i">ToString</span>())
                | _ <span class="k">-&gt;</span> ()
        )
    <span onmouseout="hideTip(event, 'fs11', 38)" onmouseover="showTip(event, 'fs11', 38)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 39)" onmouseover="showTip(event, 'fs12', 39)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Starting</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 40)" onmouseover="showTip(event, 'fs14', 40)" class="i">complete</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 41)" onmouseover="showTip(event, 'fs5', 41)" class="i">iteri</span>()
    <span onmouseout="hideTip(event, 'fs11', 42)" onmouseover="showTip(event, 'fs11', 42)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 43)" onmouseover="showTip(event, 'fs12', 43)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Done</span><span class="s">&quot;</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 44)" onmouseover="showTip(event, 'fs18', 44)" class="i">AsyncParallelExecution</span>() <span class="o">=</span> <span class="c">//Async-await</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 45)" onmouseover="showTip(event, 'fs19', 45)" class="i">iteri</span>() <span class="o">=</span> 
        [|<span class="n">1..</span><span class="n">1000</span>|] <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs6', 46)" onmouseover="showTip(event, 'fs6', 46)" class="i">Array</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 47)" onmouseover="showTip(event, 'fs7', 47)" class="i">map</span>(
            <span class="k">fun</span> <span onmouseout="hideTip(event, 'fs8', 48)" onmouseover="showTip(event, 'fs8', 48)" class="i">i</span> <span class="k">-&gt;</span> 
                <span onmouseout="hideTip(event, 'fs20', 49)" onmouseover="showTip(event, 'fs20', 49)" class="i">async</span> {
                    <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs21', 50)" onmouseover="showTip(event, 'fs21', 50)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 51)" onmouseover="showTip(event, 'fs22', 51)" class="i">Sleep</span> <span class="n">200</span>
                    <span class="k">return</span> 
                        <span class="k">match</span> <span onmouseout="hideTip(event, 'fs8', 52)" onmouseover="showTip(event, 'fs8', 52)" class="i">i</span> <span class="o">%</span> <span class="n">250</span> <span class="k">with</span>
                        | <span class="n">0</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs11', 53)" onmouseover="showTip(event, 'fs11', 53)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 54)" onmouseover="showTip(event, 'fs12', 54)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Item</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs8', 55)" onmouseover="showTip(event, 'fs8', 55)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 56)" onmouseover="showTip(event, 'fs13', 56)" class="i">ToString</span>())
                        | _ <span class="k">-&gt;</span> ()
                }
        )
    <span onmouseout="hideTip(event, 'fs11', 57)" onmouseover="showTip(event, 'fs11', 57)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 58)" onmouseover="showTip(event, 'fs12', 58)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Starting</span><span class="s">.</span><span class="s">.</span><span class="s">.</span><span class="s">&quot;</span>)
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 59)" onmouseover="showTip(event, 'fs14', 59)" class="i">complete</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 60)" onmouseover="showTip(event, 'fs19', 60)" class="i">iteri</span>() <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 61)" onmouseover="showTip(event, 'fs21', 61)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 62)" onmouseover="showTip(event, 'fs23', 62)" class="i">Parallel</span> <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs21', 63)" onmouseover="showTip(event, 'fs21', 63)" class="i">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 64)" onmouseover="showTip(event, 'fs24', 64)" class="i">RunSynchronously</span>
    <span onmouseout="hideTip(event, 'fs11', 65)" onmouseover="showTip(event, 'fs11', 65)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 66)" onmouseover="showTip(event, 'fs12', 66)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Done</span><span class="s">&quot;</span>)</pre>
</td>
</tr>
</table>

<p>The first one is slow. The second one is clearly faster. But it runs out of the threads. The third one is clearly the fastest, because it won't block the threads while executing (non-CPU-bound) async-operation.</p>

<p>Here are corresponding execution times (in interactive, with i7-laptop):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs4', 67)" onmouseover="showTip(event, 'fs4', 67)" class="i">Execution</span>();;
<span class="i">Starting</span><span class="o">..</span><span class="o">.</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">250</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">500</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">750</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">1000</span>
<span class="i">Done</span>
<span class="i">Real</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">03</span><span class="o">:</span><span class="n">20.582</span>, <span class="i">CPU</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">00.000</span>, <span onmouseout="hideTip(event, 'fs25', 68)" onmouseover="showTip(event, 'fs25', 68)" class="i">GC</span> <span class="i">gen0</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen1</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen2</span><span class="o">:</span> <span class="n">0</span>
<span class="k">val</span> <span class="i">it</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 69)" onmouseover="showTip(event, 'fs26', 69)" class="i">unit</span> <span class="o">=</span> ()
<span class="o">&gt;</span> 

<span class="o">&gt;</span> <span onmouseout="hideTip(event, 'fs15', 70)" onmouseover="showTip(event, 'fs15', 70)" class="i">ParallelExecution</span>();;
<span class="i">Starting</span><span class="o">..</span><span class="o">.</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">250</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">500</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">1000</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">750</span>
<span class="i">Done</span>
<span class="i">Real</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">22.266</span>, <span class="i">CPU</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">00.000</span>, <span onmouseout="hideTip(event, 'fs25', 71)" onmouseover="showTip(event, 'fs25', 71)" class="i">GC</span> <span class="i">gen0</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen1</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen2</span><span class="o">:</span> <span class="n">0</span>
<span class="k">val</span> <span class="i">it</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 72)" onmouseover="showTip(event, 'fs26', 72)" class="i">unit</span> <span class="o">=</span> ()

<span class="o">&gt;</span> <span class="i">AsyncParallelExecution</span>();;
<span class="i">Starting</span><span class="o">..</span><span class="o">.</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">1000</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">750</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">500</span>
<span class="i">Item</span><span class="o">:</span> <span class="n">250</span>
<span class="i">Done</span>
<span class="i">Real</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">00.204</span>, <span class="i">CPU</span><span class="o">:</span> <span class="n">00</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">00.000</span>, <span onmouseout="hideTip(event, 'fs25', 73)" onmouseover="showTip(event, 'fs25', 73)" class="i">GC</span> <span class="i">gen0</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen1</span><span class="o">:</span> <span class="n">0</span>, <span class="i">gen2</span><span class="o">:</span> <span class="n">0</span>
<span class="k">val</span> <span class="i">it</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 74)" onmouseover="showTip(event, 'fs26', 74)" class="i">unit</span> <span class="o">=</span> ()</pre>
</td>
</tr>
</table>

<h2>Message Queues</h2>

<p>There are a lot of different kind of MQ-implementation-products. What if some simple message-queue-functionality would be integrated directly to the programming language?</p>

<p>Test this source code with interactive:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span class="i">myQueue</span> <span class="o">=</span> 
    <span class="k">new</span> <span onmouseout="hideTip(event, 'fs27', 75)" onmouseover="showTip(event, 'fs27', 75)" class="i">MailboxProcessor</span><span class="o">&lt;</span><span onmouseout="hideTip(event, 'fs28', 76)" onmouseover="showTip(event, 'fs28', 76)" class="i">string</span><span class="o">&gt;</span>(<span class="k">fun</span> <span class="i">myHandler</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span class="k">rec</span> <span class="i">readNextMessage</span>() <span class="o">=</span>
            <span onmouseout="hideTip(event, 'fs20', 77)" onmouseover="showTip(event, 'fs20', 77)" class="i">async</span> {
                <span class="k">let!</span> <span class="i">result</span> <span class="o">=</span> <span class="i">myHandler</span><span class="o">.</span><span class="i">Receive</span>()
                <span onmouseout="hideTip(event, 'fs1', 78)" onmouseover="showTip(event, 'fs1', 78)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 79)" onmouseover="showTip(event, 'fs11', 79)" class="i">Console</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 80)" onmouseover="showTip(event, 'fs12', 80)" class="i">WriteLine</span>(<span class="s">&quot;</span><span class="s">Handled</span><span class="s">:</span><span class="s"> </span><span class="s">&quot;</span> <span class="o">+</span> <span class="i">result</span>)
                <span class="k">do!</span> <span class="i">readNextMessage</span>()
            }
        <span class="i">readNextMessage</span>())

<span class="i">myQueue</span><span class="o">.</span><span class="i">Post</span>(<span class="s">&quot;</span><span class="s">Hello</span><span class="s"> </span><span class="s">1</span><span class="s"> </span><span class="s">!</span><span class="s">&quot;</span>)
<span class="i">myQueue</span><span class="o">.</span><span class="i">Post</span>(<span class="s">&quot;</span><span class="s">Hello</span><span class="s"> </span><span class="s">2</span><span class="s"> </span><span class="s">!</span><span class="s">&quot;</span>)

<span class="i">myQueue</span><span class="o">.</span><span class="i">CurrentQueueLength</span> <span class="c">// 2</span>

<span class="i">myQueue</span><span class="o">.</span><span class="i">Start</span>()

<span class="i">myQueue</span><span class="o">.</span><span class="i">CurrentQueueLength</span> <span class="c">// 0</span>

<span class="i">myQueue</span><span class="o">.</span><span class="i">Post</span>(<span class="s">&quot;</span><span class="s">Hello</span><span class="s"> </span><span class="s">3</span><span class="s"> </span><span class="s">!</span><span class="s">&quot;</span>)</pre>
</td>
</tr>
</table>

<h2>Actor-model</h2>

<p>What if "objects" as capturing the program state, would be replaced with message-based solution?</p>

<p>Actor-model is a theory, which uses “Actors” as parallel-computation-items. Actor may process information, store information or communicate with other actors. Actor may even take a message which gives a totally new functionality to that actor.</p>

<p>Actor-model has been implemented to Erlang-language, but lately there have appeared actor-libraries to many programming languages.</p>

<p>The basic idea is comparable to distributed version control system: you can't actually "stop the program and see what state it is in", as the state is constantly-evolving and may look different from a different point of view.</p>

<h2>Agent-model</h2>

<p>Agent-model is basically the same thing as actor model with small differences. Agent accepts requests, so the interface is more solid. F#-language have built-in support for Agent-model and it is capsulated to the class called MailboxProcessor. Usually this is concretized like this: the master just asks for things and the background thread does the work of parsing the event history with set-theory-operations.</p>

<p>The previous example sent strings to the message-channel. Usually it is a better practice to send discriminated union commands and their parameters.</p>

<p>Static MailboxProcessor.Start is equivalent of creating new MailboxProcessor() and then calling its .Start(). It is easy to construct time-outs, exception handling and cancellation-operations for agents.</p>

<p>Test the following source code:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span class="i">``Person agent methods``</span> <span class="o">=</span>
| <span class="i">AddPerson</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs28', 81)" onmouseover="showTip(event, 'fs28', 81)" class="i">string</span> <span class="o">*</span> <span onmouseout="hideTip(event, 'fs29', 82)" onmouseover="showTip(event, 'fs29', 82)" class="i">int</span> <span class="c">//Name*Age</span>
| <span class="i">GetPeople</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs30', 83)" onmouseover="showTip(event, 'fs30', 83)" class="i">AsyncReplyChannel</span><span class="o">&lt;</span>(<span onmouseout="hideTip(event, 'fs28', 84)" onmouseover="showTip(event, 'fs28', 84)" class="i">string</span><span class="o">*</span><span onmouseout="hideTip(event, 'fs29', 85)" onmouseover="showTip(event, 'fs29', 85)" class="i">int</span>) <span onmouseout="hideTip(event, 'fs31', 86)" onmouseover="showTip(event, 'fs31', 86)" class="i">list</span><span class="o">&gt;</span>

<span class="k">let</span> <span class="i">myQueue2</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs27', 87)" onmouseover="showTip(event, 'fs27', 87)" class="i">MailboxProcessor</span><span class="o">&lt;</span><span class="i">``Person agent methods``</span><span class="o">&gt;</span><span class="o">.</span><span class="i">Start</span>(<span class="k">fun</span> <span class="i">myHandler</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span class="k">rec</span> <span class="i">readNextMessage</span> <span class="i">people</span> <span class="o">=</span>
            <span onmouseout="hideTip(event, 'fs20', 88)" onmouseover="showTip(event, 'fs20', 88)" class="i">async</span> {
                <span class="k">let!</span> <span class="i">result</span> <span class="o">=</span> <span class="i">myHandler</span><span class="o">.</span><span class="i">Receive</span>()
                <span class="k">match</span> <span class="i">result</span> <span class="k">with</span>
                | <span class="i">AddPerson</span>(<span class="i">n</span>,<span class="i">s</span>) <span class="k">-&gt;</span>
                    <span class="k">return!</span> <span class="i">readNextMessage</span> ((<span class="i">n</span>,<span class="i">s</span>)<span class="o">::</span><span class="i">people</span>)
                | <span class="i">GetPeople</span>(<span class="i">response</span>) <span class="k">-&gt;</span>
                    <span class="k">let</span> <span class="i">p</span> <span class="o">=</span> <span class="i">people</span>
                    <span class="i">response</span><span class="o">.</span><span class="i">Reply</span>(<span class="i">p</span>)
                    <span class="k">return!</span> <span class="i">readNextMessage</span> <span class="i">people</span>
            }
        <span class="i">readNextMessage</span> [])

<span class="k">let</span> <span class="i">addPerson</span> <span class="o">=</span>  <span class="i">AddPerson</span> <span class="o">&gt;</span><span class="o">&gt;</span> <span class="i">myQueue2</span><span class="o">.</span><span class="i">Post</span> 
(<span class="s">&quot;</span><span class="s">Matti</span><span class="s">&quot;</span>, <span class="n">30</span>) <span class="o">|&gt;</span> <span class="i">addPerson</span>
(<span class="s">&quot;</span><span class="s">Maija</span><span class="s">&quot;</span>, <span class="n">7</span>) <span class="o">|&gt;</span> <span class="i">addPerson</span> 

<span class="k">let</span> <span class="i">res</span> <span class="o">=</span> <span class="i">myQueue2</span><span class="o">.</span><span class="i">PostAndReply</span>(<span class="i">GetPeople</span>)</pre>
</td>
</tr>
</table>

<p>In addition to PostAndReply there is also AsyncPostAndReply</p>

<h3>We want more...</h3>

<p>This was just a single agent, which by itself doesn't separate very much from  .NET ConcurrentDictionary<K, T> other than this: The programming interface is business-logical methods and not CRUD-operations. But the real benefits come to life when there are a lot of actors:</p>

<p>Instead of object-inheritance (or enum-type-properties) using agents to communicate with each other.</p>

<p><img src="fig1.jpg" alt="" /></p>

<p><em>(image source: <a href="http://www.developerfusion.com/article/140677/writing-concurrent-applications-using-f-agents/">Writing Concurrent Applications Using F# Agents</a>)</em></p>

<h2>Exercises</h2>

<h4>Exercise 1</h4>

<p>Add a new method to "Person agent methods": a method that will return only people over the age of 18 years.</p>

<h4>Exercise 2</h4>

<p>Modify the "Person agent methods" agent to be "unprocessed people" and make also another agent, "processed people":</p>

<ul>
<li>Create a small business-logic and communication, how the un-processed people moves to processed people.</li>
<li>Change the interface to asynchronous (AsyncPostAndReply)</li>
<li>You can also encapsulate the agent inside a type.</li>
</ul>

<p><a href="../ReadmeEng.html">Back to the menu</a></p>

          <div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Threading</div>
<div class="tip" id="fs3">namespace System.Threading.Tasks</div>
<div class="tip" id="fs4">val Execution : unit -&gt; unit<br /><br />Full name: AgentModelEng.Execution</div>
<div class="tip" id="fs5">val iteri : (unit -&gt; unit [])</div>
<div class="tip" id="fs6">type Array =<br />&#160;&#160;member Clone : unit -&gt; obj<br />&#160;&#160;member CopyTo : array:Array * index:int -&gt; unit + 1 overload<br />&#160;&#160;member GetEnumerator : unit -&gt; IEnumerator<br />&#160;&#160;member GetLength : dimension:int -&gt; int<br />&#160;&#160;member GetLongLength : dimension:int -&gt; int64<br />&#160;&#160;member GetLowerBound : dimension:int -&gt; int<br />&#160;&#160;member GetUpperBound : dimension:int -&gt; int<br />&#160;&#160;member GetValue : params indices:int[] -&gt; obj + 7 overloads<br />&#160;&#160;member Initialize : unit -&gt; unit<br />&#160;&#160;member IsFixedSize : bool<br />&#160;&#160;...<br /><br />Full name: System.Array</div>
<div class="tip" id="fs7">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.Array.map</div>
<div class="tip" id="fs8">val i : int</div>
<div class="tip" id="fs9">Multiple items<br />type Thread =<br />&#160;&#160;inherit CriticalFinalizerObject<br />&#160;&#160;new : start:ThreadStart -&gt; Thread + 3 overloads<br />&#160;&#160;member Abort : unit -&gt; unit + 1 overload<br />&#160;&#160;member ApartmentState : ApartmentState with get, set<br />&#160;&#160;member CurrentCulture : CultureInfo with get, set<br />&#160;&#160;member CurrentUICulture : CultureInfo with get, set<br />&#160;&#160;member DisableComObjectEagerCleanup : unit -&gt; unit<br />&#160;&#160;member ExecutionContext : ExecutionContext<br />&#160;&#160;member GetApartmentState : unit -&gt; ApartmentState<br />&#160;&#160;member GetCompressedStack : unit -&gt; CompressedStack<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.Threading.Thread<br /><br />--------------------<br />Thread(start: ThreadStart) : unit<br />Thread(start: ParameterizedThreadStart) : unit<br />Thread(start: ThreadStart, maxStackSize: int) : unit<br />Thread(start: ParameterizedThreadStart, maxStackSize: int) : unit</div>
<div class="tip" id="fs10">Thread.Sleep(timeout: TimeSpan) : unit<br />Thread.Sleep(millisecondsTimeout: int) : unit</div>
<div class="tip" id="fs11">type Console =<br />&#160;&#160;static member BackgroundColor : ConsoleColor with get, set<br />&#160;&#160;static member Beep : unit -&gt; unit + 1 overload<br />&#160;&#160;static member BufferHeight : int with get, set<br />&#160;&#160;static member BufferWidth : int with get, set<br />&#160;&#160;static member CapsLock : bool<br />&#160;&#160;static member Clear : unit -&gt; unit<br />&#160;&#160;static member CursorLeft : int with get, set<br />&#160;&#160;static member CursorSize : int with get, set<br />&#160;&#160;static member CursorTop : int with get, set<br />&#160;&#160;static member CursorVisible : bool with get, set<br />&#160;&#160;...<br /><br />Full name: System.Console</div>
<div class="tip" id="fs12">Console.WriteLine() : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: string) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: obj) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: uint64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: uint32) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: float32) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: float) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />Console.WriteLine(value: decimal) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs13">Int32.ToString() : string<br />Int32.ToString(provider: IFormatProvider) : string<br />Int32.ToString(format: string) : string<br />Int32.ToString(format: string, provider: IFormatProvider) : string</div>
<div class="tip" id="fs14">val complete : unit []</div>
<div class="tip" id="fs15">val ParallelExecution : unit -&gt; unit<br /><br />Full name: AgentModelEng.ParallelExecution</div>
<div class="tip" id="fs16">module Parallel<br /><br />from Microsoft.FSharp.Collections.ArrayModule</div>
<div class="tip" id="fs17">val map : mapping:(&#39;T -&gt; &#39;U) -&gt; array:&#39;T [] -&gt; &#39;U []<br /><br />Full name: Microsoft.FSharp.Collections.ArrayModule.Parallel.map</div>
<div class="tip" id="fs18">val AsyncParallelExecution : unit -&gt; unit<br /><br />Full name: AgentModelEng.AsyncParallelExecution</div>
<div class="tip" id="fs19">val iteri : (unit -&gt; Async&lt;unit&gt; [])</div>
<div class="tip" id="fs20">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs21">Multiple items<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs22">static member Async.Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;</div>
<div class="tip" id="fs23">static member Async.Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;</div>
<div class="tip" id="fs24">static member Async.RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T</div>
<div class="tip" id="fs25">type GC =<br />&#160;&#160;static member AddMemoryPressure : bytesAllocated:int64 -&gt; unit<br />&#160;&#160;static member CancelFullGCNotification : unit -&gt; unit<br />&#160;&#160;static member Collect : unit -&gt; unit + 2 overloads<br />&#160;&#160;static member CollectionCount : generation:int -&gt; int<br />&#160;&#160;static member GetGeneration : obj:obj -&gt; int + 1 overload<br />&#160;&#160;static member GetTotalMemory : forceFullCollection:bool -&gt; int64<br />&#160;&#160;static member KeepAlive : obj:obj -&gt; unit<br />&#160;&#160;static member MaxGeneration : int<br />&#160;&#160;static member ReRegisterForFinalize : obj:obj -&gt; unit<br />&#160;&#160;static member RegisterForFullGCNotification : maxGenerationThreshold:int * largeObjectHeapThreshold:int -&gt; unit<br />&#160;&#160;...<br /><br />Full name: System.GC</div>
<div class="tip" id="fs26">type unit = Unit<br /><br />Full name: Microsoft.FSharp.Core.unit</div>
<div class="tip" id="fs27">Multiple items<br />type MailboxProcessor&lt;&#39;Msg&gt; =<br />&#160;&#160;interface IDisposable<br />&#160;&#160;new : body:(MailboxProcessor&lt;&#39;Msg&gt; -&gt; Async&lt;unit&gt;) * ?cancellationToken:CancellationToken -&gt; MailboxProcessor&lt;&#39;Msg&gt;<br />&#160;&#160;member Post : message:&#39;Msg -&gt; unit<br />&#160;&#160;member PostAndAsyncReply : buildMessage:(AsyncReplyChannel&lt;&#39;Reply&gt; -&gt; &#39;Msg) * ?timeout:int -&gt; Async&lt;&#39;Reply&gt;<br />&#160;&#160;member PostAndReply : buildMessage:(AsyncReplyChannel&lt;&#39;Reply&gt; -&gt; &#39;Msg) * ?timeout:int -&gt; &#39;Reply<br />&#160;&#160;member PostAndTryAsyncReply : buildMessage:(AsyncReplyChannel&lt;&#39;Reply&gt; -&gt; &#39;Msg) * ?timeout:int -&gt; Async&lt;&#39;Reply option&gt;<br />&#160;&#160;member Receive : ?timeout:int -&gt; Async&lt;&#39;Msg&gt;<br />&#160;&#160;member Scan : scanner:(&#39;Msg -&gt; Async&lt;&#39;T&gt; option) * ?timeout:int -&gt; Async&lt;&#39;T&gt;<br />&#160;&#160;member Start : unit -&gt; unit<br />&#160;&#160;member TryPostAndReply : buildMessage:(AsyncReplyChannel&lt;&#39;Reply&gt; -&gt; &#39;Msg) * ?timeout:int -&gt; &#39;Reply option<br />&#160;&#160;...<br /><br />Full name: Microsoft.FSharp.Control.MailboxProcessor&lt;_&gt;<br /><br />--------------------<br />new : body:(MailboxProcessor&lt;&#39;Msg&gt; -&gt; Async&lt;unit&gt;) * ?cancellationToken:CancellationToken -&gt; MailboxProcessor&lt;&#39;Msg&gt;</div>
<div class="tip" id="fs28">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs29">Multiple items<br />val int : value:&#39;T -&gt; int (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.int<br /><br />--------------------<br />type int = int32<br /><br />Full name: Microsoft.FSharp.Core.int<br /><br />--------------------<br />type int&lt;&#39;Measure&gt; = int<br /><br />Full name: Microsoft.FSharp.Core.int&lt;_&gt;</div>
<div class="tip" id="fs30">type AsyncReplyChannel&lt;&#39;Reply&gt;<br />member Reply : value:&#39;Reply -&gt; unit<br /><br />Full name: Microsoft.FSharp.Control.AsyncReplyChannel&lt;_&gt;</div>
<div class="tip" id="fs31">type &#39;T list = List&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
          
        </div>
        <div class="span1"></div>
      </div>
    </div>
	<br/><div style="color:gray; text-align: center;">Materials: (c) Tuomas Hietanen, 2014</div>
  </body>
</html>